<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Navigating Connections: Swipe Right on Self-Awareness!</title>
    <!-- Tailwind CSS CDN for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Import Luckiest Guy font from Google Fonts */
        @import url('https://fonts.googleapis.com/css2?family=Luckiest+Guy&display=swap');

        /* Custom styles for the Inter font and general body styling */
        body {
            font-family: 'Inter', sans-serif;
            /* New vibrant gradient background */
            background: linear-gradient(135deg, #84fab0 0%, #8fd3f4 100%); /* Fresh green-blue gradient */
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 1rem;
            box-sizing: border-box;
            overflow-y: auto; /* Allow scrolling if content overflows */
        }

        /* Main game container */
        .game-container {
            background-color: #ffffff;
            padding: 2.5rem;
            border-radius: 1.5rem;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.25);
            width: 95%;
            max-width: 900px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            margin-bottom: 2rem;
            /* New complementary border color */
            border: 2px solid #4CAF50; /* A vibrant green */
        }

        /* Title styling */
        h1 {
            font-family: 'Luckiest Guy', cursive; /* Applied new font */
            font-size: 4.5rem; /* Increased size for impact on TV screens */
            font-weight: 400; /* Luckiest Guy is usually one weight */
            text-align: center;
            color: #2c3e50; /* Dark blue-gray */
            margin-bottom: 1.5rem;
            /* Enhanced text shadow for more depth */
            text-shadow: 4px 4px 0px rgba(0, 0, 0, 0.1), 6px 6px 0px rgba(0, 0, 0, 0.05);
            line-height: 1.2; /* Adjust line height if needed for multi-line title */
        }

        /* Profile card styling */
        .profile-card {
            /* New light background for profile card */
            background-color: #e8f5e9; /* Very light green */
            padding: 2rem;
            border-radius: 1rem;
            width: 100%;
            margin-bottom: 2rem;
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.05);
            /* New complementary border color */
            border: 1px solid #a5d6a7; /* Lighter green border */
        }

        .profile-header {
            display: flex;
            justify-content: space-between;
            align-items: baseline;
            margin-bottom: 1rem;
        }

        .profile-name {
            font-size: 2.5rem;
            font-weight: 700;
            /* New profile name color */
            color: #1b5e20; /* Darker green */
        }

        .profile-details {
            font-size: 1.5rem;
            color: #4a5568;
        }

        .profile-bio {
            font-size: 1.4rem;
            color: #333;
            line-height: 1.6;
            margin-bottom: 1.5rem;
            font-style: italic;
        }

        /* Profile Image Section */
        .profile-image-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 2rem;
        }

        #profileImage {
            /* Increased size for TV screens */
            width: 300px;
            height: 300px;
            border-radius: 50%; /* Circular image */
            object-fit: cover;
            /* New image border color */
            border: 4px solid #4CAF50; /* Green border */
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            margin-bottom: 1rem;
        }

        /* Removed image-loading-spinner and generateImageButton styles as they are no longer needed */

        /* Flag revelation buttons */
        .flag-buttons {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .flag-button {
            padding: 1rem 2rem;
            border-radius: 0.75rem;
            font-weight: bold;
            font-size: 1.5rem;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
            border: none;
        }

        /* These colors remain distinct for their meaning */
        .flag-button.green { background-color: #28a745; } /* Green */
        .flag-button.yellow { background-color: #ffc107; color: #333;} /* Yellow */
        .flag-button.red { background-color: #dc3545; } /* Red */
        .flag-button.reflection { background-color: #6c757d; } /* Gray for Reflection */
        /* Removed .flag-button.generate-image as it's no longer needed */


        .flag-button:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.2);
            opacity: 0.9;
        }
        .flag-button:active:not(:disabled) {
            transform: translateY(0);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        .flag-button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
            opacity: 0.7;
        }

        /* Flag analysis display */
        .flag-analysis-section {
            background-color: #ecf0f1; /* Light gray */
            padding: 1.5rem;
            border-radius: 0.75rem;
            margin-top: 1.5rem;
            border: 1px solid #bdc3c7;
        }
        .flag-analysis-section h3 {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 1rem;
            text-align: center;
        }
        .flag-analysis-section ul {
            list-style: none;
            padding: 0;
        }
        .flag-analysis-section li {
            font-size: 1.3rem;
            margin-bottom: 0.5rem;
            padding-left: 1.5rem;
            position: relative;
        }
        .flag-analysis-section li:before {
            content: '•';
            position: absolute;
            left: 0;
            color: #333;
            font-weight: bold;
        }

        /* Specific flag colors for list items (remain distinct) */
        .flag-analysis-section.green-flags h3 { color: #28a745; }
        .flag-analysis-section.yellow-flags h3 { color: #ffc107; }
        .flag-analysis-section.red-flags h3 { color: #dc3545; }
        .flag-analysis-section.reflection-prompts h3 { color: #6c757d; }

        /* Navigation buttons */
        .nav-buttons {
            display: flex;
            justify-content: space-between;
            width: 100%;
            margin-top: 2.5rem;
        }
        .nav-button {
            background-color: #007bff;
            color: white;
            font-weight: bold;
            padding: 1rem 2rem;
            border-radius: 0.75rem;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
            transition: all 0.3s ease;
            cursor: pointer;
            border: none;
            font-size: 1.4rem;
        }
        .nav-button:hover:not(:disabled) {
            background-color: #0056b3;
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.2);
        }
        .nav-button:active:not(:disabled) {
            transform: translateY(0);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        .nav-button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
            opacity: 0.7;
        }

        /* Message box styling */
        .message-box {
            margin-top: 2rem;
            padding: 1rem 2rem;
            border-radius: 0.75rem;
            font-size: 1.4rem;
            font-weight: 600;
            text-align: center;
            width: 100%;
            max-width: 600px;
        }
        .message-box.info {
            background-color: #e0f2f7; /* Light blue for info */
            border: 1px solid #81d4fa; /* Blue border for info */
            color: #01579b; /* Dark blue text for info */
        }
        .message-box.success {
            background-color: #d1fae5;
            border: 1px solid #34d399;
            color: #065f46;
        }
        .message-box.error {
            background-color: #fee2e2;
            border: 1px solid #ef4444;
            color: #991b1b;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            h1 {
                font-size: 2.8rem; /* Adjusted for smaller screens */
            }
            .profile-name {
                font-size: 2rem;
            }
            .profile-details {
                font-size: 1.2rem;
            }
            .profile-bio {
                font-size: 1.1rem;
            }
            .flag-button {
                font-size: 1.2rem;
                padding: 0.8rem 1.5rem;
            }
            .flag-analysis-section h3 {
                font-size: 1.5rem;
            }
            .flag-analysis-section li {
                font-size: 1.1rem;
            }
            .nav-button {
                font-size: 1.2rem;
                padding: 0.8rem 1.5rem;
            }
            .message-box {
                font-size: 1.1rem;
            }
            #profileImage {
                /* Adjusted size for smaller screens */
                width: 200px;
                height: 200px;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1>Navigating Connections: Swipe Right on Self-Awareness!</h1>
        <p class="text-lg text-gray-700 text-center mb-4">
            Review the profile, discuss with your group, then reveal the flags and reflection prompts.
        </p>

        <div id="profileCard" class="profile-card">
            <div class="profile-header">
                <span id="profileName" class="profile-name"></span>
                <span id="profileDetails" class="profile-details"></span>
            </div>
            <p id="profileBio" class="profile-bio"></p>

            <!-- Profile Image Section -->
            <div class="profile-image-section">
                <img id="profileImage" src="images/profiles/placeholder.png" alt="Profile Image Placeholder">
            </div>

            <div id="flagAnalysisContainer">
                <!-- Flag analysis will be displayed here -->
            </div>
            <div id="reflectionPromptsContainer">
                <!-- Reflection prompts will be displayed here -->
            </div>
        </div>

        <div class="flag-buttons">
            <button id="showGreenFlags" class="flag-button green">Show Green Flags ✅</button>
            <button id="showYellowFlags" class="flag-button yellow">Show Yellow Flags ⚠️</button>
            <button id="showRedFlags" class="flag-button red">Show Red Flags 🚩</button>
            <button id="showReflectionPrompts" class="flag-button reflection">Show Reflection Prompts 🤔</button>
        </div>

        <div class="nav-buttons">
            <button id="prevProfile" class="nav-button">Previous Profile</button>
            <button id="nextProfile" class="nav-button">Next Profile</button>
            <button id="restartGame" class="nav-button">Restart Game</button>
        </div>

        <!-- Message Box for User Feedback -->
        <div id="messageBox" class="hidden message-box" role="alert">
            <!-- Message will be inserted here by JavaScript -->
        </div>
    </div>

    <script>
// ---- Demo profiles so navigation & flags work immediately ----
const profiles = [
  {
    name: "HighVibeHealer",
    gender: "F",
    age: 34,
    bio: "Serene, grounded, and plant-loving. Meditation partner preferred.",
    imageUrl: "images/profiles/HighVibeHealer.png",
    greenFlags: [
      "Consistent follow-through on plans",
      "Communicates feelings directly",
      "Stable daily routines"
    ],
    yellowFlags: [
      "Sometimes overcommits to wellness fads",
      "Avoids conflict until it builds up"
    ],
    redFlags: [
      "Love-bombs early (too fast, too soon)"
    ],
    reflections: [
      "What boundaries would help you feel safe here?",
      "How would you check for pattern vs one-off?"
    ]
  },
  {
    name: "BananaBreadBen",
    gender: "M",
    age: 29,
    bio: "Bakes on weekends, kindness every day. Looking for a co-taster.",
    imageUrl: "images/profiles/BananaBreadBen.png",
    greenFlags: ["Nurturing with acts of service"],
    yellowFlags: ["May people-please to avoid conflict"],
    redFlags: ["Ghosted an ex instead of ending it respectfully"],
    reflections: ["What pace feels healthy in the first 4–6 weeks?"]
  }
];

// ---- Image extension fallback ----
const TRY_EXTS = [".png", ".jpg", ".jpeg", ".webp"];
async function pickImage(basePath) {
  for (const ext of TRY_EXTS) {
    const url = `${basePath}${ext}?v=${Date.now()}`; // cache-bust
    try {
      const res = await fetch(url, { method: "HEAD", cache: "no-store" });
      if (res.ok) return url;
    } catch {}
  }
  return "images/profiles/placeholder.png";
}

// ---- Cache core elements ----
const el = {
  name: document.getElementById("profileName"),
  details: document.getElementById("profileDetails"),
  bio: document.getElementById("profileBio"),
  img: document.getElementById("profileImage"),
  next: document.getElementById("nextProfile") || document.getElementById("nextButton"),
  prev: document.getElementById("prevProfile") || document.getElementById("prevButton"),
  restart: document.getElementById("restartGame"),
};

let idx = 0;

function renderProfile() {
  const p = profiles[idx];
  if (!p) return;
  if (el.name) el.name.textContent = p.name ?? "";
  if (el.details) el.details.textContent = `${p.gender ?? ""}, ${p.age ?? ""}`;
  if (el.bio) el.bio.textContent = p.bio ?? "";
  const base = (p.imageUrl ?? "images/profiles/placeholder.png").replace(/\.(png|jpg|jpeg|webp)$/i, "");
  pickImage(base).then(url => { if (el.img) el.img.src = url; });
}

function showNextProfile() { idx = (idx + 1) % profiles.length; renderProfile(); }
function showPreviousProfile() { idx = (idx - 1 + profiles.length) % profiles.length; renderProfile(); }

// ----- Overlay panel for flags/reflections -----
function ensurePanel() {
  let panel = document.getElementById("flagPanel");
  if (panel) return panel;

  panel = document.createElement("div");
  panel.id = "flagPanel";
  panel.style.position = "fixed";
  panel.style.inset = "0";
  panel.style.background = "rgba(0,0,0,0.35)";
  panel.style.display = "flex";
  panel.style.alignItems = "center";
  panel.style.justifyContent = "center";
  panel.style.zIndex = "9999";

  panel.innerHTML = `
    <div style="max-width:720px;width:90%;background:#fff;border-radius:16px;padding:20px;box-shadow:0 10px 30px rgba(0,0,0,.2)">
      <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:10px;">
        <h2 id="panelTitle" style="font-size:22px;margin:0;color:#14532d;">Details</h2>
        <button id="panelClose" style="background:#14532d;color:#fff;border:none;border-radius:8px;padding:8px 12px;cursor:pointer">Close</button>
      </div>
      <ul id="panelList" style="margin:0;padding-left:18px;line-height:1.6"></ul>
    </div>
  `;
  document.body.appendChild(panel);
  panel.addEventListener("click", (e) => {
    if (e.target.id === "flagPanel" || e.target.id === "panelClose") panel.remove();
  });
  return panel;
}

function openPanel(title, items) {
  const panel = ensurePanel();
  panel.querySelector("#panelTitle").textContent = title;
  const list = panel.querySelector("#panelList");
  list.innerHTML = "";
  (items && items.length ? items : ["(Nothing added yet)"]).forEach(txt => {
    const li = document.createElement("li");
    li.textContent = txt;
    list.appendChild(li);
  });
}

// ---- Bind all buttons (by id or visible text) ----
function bindFlagButtons() {
  const byId = {
    green: document.getElementById("showGreenFlags"),
    yellow: document.getElementById("showYellowFlags"),
    red: document.getElementById("showRedFlags"),
    reflect: document.getElementById("showReflectionPrompts")
  };

  const handlers = {
    green: () => openPanel("✅ Green Flags", (profiles[idx].greenFlags || [])),
    yellow: () => openPanel("🟨 Yellow Flags", (profiles[idx].yellowFlags || [])),
    red: () => openPanel("🚩 Red Flags", (profiles[idx].redFlags || [])),
    reflect: () => openPanel("🧠 Reflection Prompts", (profiles[idx].reflections || []))
  };

  const ensure = (btn, handler) => { if (btn) btn.addEventListener("click", handler); };
  ensure(byId.green, handlers.green);
  ensure(byId.yellow, handlers.yellow);
  ensure(byId.red, handlers.red);
  ensure(byId.reflect, handlers.reflect);

  // Fallback: match by visible text if IDs differ
  const allBtns = Array.from(document.querySelectorAll("button"));
  const findByText = (start) => allBtns.find(b =>
    (b.textContent || "").replace(/\s+/g," ").trim().toLowerCase().startsWith(start)
  );
  if (!byId.green) { const b = findByText("show green flags"); if (b) ensure(b, handlers.green); }
  if (!byId.yellow) { const b = findByText("show yellow flags"); if (b) ensure(b, handlers.yellow); }
  if (!byId.red) { const b = findByText("show red flags"); if (b) ensure(b, handlers.red); }
  if (!byId.reflect) { const b = findByText("show reflection"); if (b) ensure(b, handlers.reflect); }
}

document.addEventListener("DOMContentLoaded", () => {
  if (el.next) el.next.addEventListener("click", showNextProfile);
  if (el.prev) el.prev.addEventListener("click", showPreviousProfile);
  if (el.restart) el.restart.addEventListener("click", () => { idx = 0; renderProfile(); });

  bindFlagButtons();
  renderProfile();
});
</script>
</body>
</html>
